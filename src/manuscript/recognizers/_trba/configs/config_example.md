# Конфигурация TRBA модели

## Параметры для TRBA (обязательные)

**`img_h`** - Высота входного изображения для модели в пикселях

**`img_w`** - Ширина входного изображения для модели в пикселях  

**`hidden_size`** - Размер скрытого слоя в RNN части модели

## Параметры для обучения (обязательные при обучении)

**`charset_path`** - Путь к файлу с алфавитом символов

## Дополнительные параметры

**`max_len`** - Максимальная длина распознаваемой последовательности символов

**`encoding`** - Кодировка для обработки текстовых данных

## Параметры для обучения

**`train_csvs`** - Пути к CSV файлам с метками для обучения

**`train_roots`** - Корневые папки с изображениями для обучения

**`val_csvs`** - Пути к CSV файлам с метками для валидации

**`val_roots`** - Корневые папки с изображениями для валидации

**`batch_size`** - Размер батча для обучения

**`epochs`** - Максимальное количество эпох обучения

**`lr`** - Скорость обучения (learning rate)

**`optimizer`** - Алгоритм оптимизации ("Adam", "SGD", "AdamW")

**`scheduler`** - Планировщик изменения learning rate

**`weight_decay`** - Коэффициент регуляризации L2

**`momentum`** - Коэффициент momentum для SGD оптимизатора

**`shift_limit`** - Максимальный сдвиг изображения при аугментации

**`scale_limit`** - Максимальное масштабирование при аугментации

**`rotate_limit`** - Максимальный поворот в градусах при аугментации

**`p_ShiftScaleRotate`** - Вероятность применения геометрических трансформаций

**`brightness_limit`** - Изменение яркости при аугментации

**`contrast_limit`** - Изменение контрастности при аугментации

**`p_BrightnessContrast`** - Вероятность применения цветовых трансформаций

**`invert_p`** - Вероятность инверсии цветов

**`train_proportions`** - Пропорции для смешивания нескольких датасетов

**`val_size`** - Количество примеров для валидации

**`num_workers`** - Количество процессов для загрузки данных

**`resume_path`** - Путь к чекпойнту для продолжения обучения

**`exp_dir`** - Название папки для сохранения результатов эксперимента

**`seed`** - Зерно для генератора случайных чисел

**`eval_every`** - Частота валидации в эпохах

## Пример полного config.json файла

```json
{
    "train_csvs": [
        "path/to/train/labels1.csv",
        "path/to/train/labels2.csv"
    ],
    "train_roots": [
        "path/to/train/images1",
        "path/to/train/images2"
    ],
    "val_csvs": [
        "path/to/val/labels1.csv",
        "path/to/val/labels2.csv"
    ],
    "val_roots": [
        "path/to/val/images1",
        "path/to/val/images2"
    ],
    "charset_path": "path/to/charset.txt",
    "encoding": "utf-8",
    "img_h": 32,
    "img_w": 128,
    "max_len": 40,
    "hidden_size": 256,
    "batch_size": 64,
    "epochs": 100,
    "lr": 0.001,
    "optimizer": "Adam",
    "scheduler": "StepLR",
    "weight_decay": 1e-4,
    "momentum": 0.9,
    "shift_limit": 0.05,
    "scale_limit": 0.05,
    "rotate_limit": 5,
    "p_ShiftScaleRotate": 0.5,
    "brightness_limit": 0.2,
    "contrast_limit": 0.2,
    "p_BrightnessContrast": 0.3,
    "invert_p": 0.02,
    "train_proportions": [0.6, 0.4],
    "val_size": 500,
    "num_workers": 4,
    "resume_path": "path/to/checkpoint.pth",
    "exp_dir": "path/to/experiments",
    "seed": 123,
    "eval_every": 5
}
```

## Пример charset.txt файла

**Важно**: Первые 4 строки обязательны и должны быть именно в таком порядке, затем можно добавлять нужные символы.

```plaintext
<PAD>
<SOS>
<EOS>
 
a
b
c
0
1
2
А
Б
.
,
```

**Обязательные служебные токены:**
- `<PAD>` - токен заполнения (padding)
- `<SOS>` - токен начала последовательности (Start of Sequence)  
- `<EOS>` - токен конца последовательности (End of Sequence)
- ` ` - пробел (4-я строка, обязательна)

**Символы для распознавания:**
- Латинские буквы (a-z, A-Z)
- Цифры (0-9)  
- Кириллические буквы (а-я, А-Я)
- Знаки препинания и специальные символы

Можно настроить под свой алфавит, добавляя или удаляя символы после первых 4 обязательных строк.